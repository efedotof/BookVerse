/********************************************/
/*                                          */
/*        üì± –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: BookVerse      */
/*        üìö –û–ø–∏—Å–∞–Ω–∏–µ: –≠—Ç–æ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∫–Ω–∏–≥. –û—Ç–∫—Ä–æ–π—Ç–µ –º–∏—Ä –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã –ø—Ä—è–º–æ —Å –≤–∞—à–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –≥–¥–µ –±—ã –≤—ã –Ω–∏ –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å. –° –ª–µ–≥–∫–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–∞–π—Ç–µ –∏ —á–∏—Ç–∞–π—Ç–µ —Å–≤–æ–∏ –ª—é–±–∏–º—ã–µ –∫–Ω–∏–≥–∏ –∏–∑ –ø–∞–º—è—Ç–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö.    */
/*        üë§ –ê–≤—Ç–æ—Ä: efedotov                       */
/*        üìÖ –î–∞—Ç–∞: 2023-07-29                 */
/*        üöÄ –í–µ—Ä—Å–∏—è: 0.0                         */
/*                                          */
/*        ¬© –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.                */
/*                                          */
/// *****************************************
List<String> splitText(String text, double fontSize, double screenWidth, double screenHeight) {
  List<String> pages = []; // –°–ø–∏—Å–æ–∫ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–∞–∑–±–∏—Ç—ã—Ö —á–∞—Å—Ç–µ–π —Ç–µ–∫—Å—Ç–∞

  int startIndex = 0; // –ò–Ω–¥–µ–∫—Å –Ω–∞—á–∞–ª–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  int endIndex = 0; // –ò–Ω–¥–µ–∫—Å –∫–æ–Ω—Ü–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –ø–æ–º–µ—Å—Ç–∏—Ç—å –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º —Ä–∞–∑–º–µ—Ä–µ —à—Ä–∏—Ñ—Ç–∞
  int maxCharactersPerPage = ((screenWidth ~/ fontSize) * (screenHeight ~/ fontSize)).truncate();

  // –ü–æ–∫–∞ —Ç–µ–∫—Å—Ç –Ω–µ –∑–∞–∫–æ–Ω—á–µ–Ω, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–∑–±–∏–≤–∞—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  while (startIndex < text.length) {
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω–µ—Ü —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    endIndex = startIndex + maxCharactersPerPage;

    // –ï—Å–ª–∏ –∫–æ–Ω–µ—Ü —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —Ç–µ–∫—Å—Ç–∞, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º endIndex –≤ –∫–æ–Ω–µ—Ü —Ç–µ–∫—Å—Ç–∞
    if (endIndex > text.length) {
      endIndex = text.length;
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ–±—ã —Å–ª–æ–≤–∞ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–ª–∏—Å—å
    if (endIndex < text.length && !text.substring(endIndex, endIndex + 1).contains(RegExp(r'\s'))) {
      // –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π —Å–∏–º–≤–æ–ª –Ω–µ –ø—Ä–æ–±–µ–ª, –ø–µ—Ä–µ–º–µ—â–∞–µ–º endIndex –≤–ª–µ–≤–æ, –ø–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–º –ø—Ä–æ–±–µ–ª
      while (endIndex > startIndex && !text.substring(endIndex - 1, endIndex).contains(RegExp(r'\s'))) {
        endIndex--;
      }
    }

    // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ —Å–ø–∏—Å–æ–∫
    pages.add(text.substring(startIndex, endIndex));

    // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    startIndex = endIndex;
    print(pages);
  }

  return pages;
}